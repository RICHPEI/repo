# Excel è³‡æ–™æ¸…æ´—å·¥å…· - å®Œæ•´ä½¿ç”¨æ‰‹å†Š

**ç‰ˆæœ¬ï¼šv2.0.0**
**æœ€å¾Œæ›´æ–°ï¼š2025-11-29**

---

## ğŸ“‘ ç›®éŒ„

- [å¿«é€Ÿé–‹å§‹](#å¿«é€Ÿé–‹å§‹)
- [ç³»çµ±éœ€æ±‚](#ç³»çµ±éœ€æ±‚)
- [å®‰è£æŒ‡å—](#å®‰è£æŒ‡å—)
- [åŸºæœ¬ä½¿ç”¨](#åŸºæœ¬ä½¿ç”¨)
- [é€²éšåŠŸèƒ½](#é€²éšåŠŸèƒ½)
- [ç¨‹å¼æ¶æ§‹](#ç¨‹å¼æ¶æ§‹)
- [æµç¨‹åœ–è§£](#æµç¨‹åœ–è§£)
- [API åƒè€ƒ](#api-åƒè€ƒ)
- [å¸¸è¦‹å•é¡Œ](#å¸¸è¦‹å•é¡Œ)
- [æ•…éšœæ’é™¤](#æ•…éšœæ’é™¤)
- [æœ€ä½³å¯¦è¸](#æœ€ä½³å¯¦è¸)

---

## ğŸš€ å¿«é€Ÿé–‹å§‹

### ä¸‰æ­¥é©Ÿå®Œæˆè³‡æ–™æ¸…æ´—

```bash
# 1. å®‰è£ä¾è³´
pip install -r requirements.txt

# 2. åŸ·è¡Œç¨‹å¼
python -m src.main -i input.xlsx -o output.xlsx

# 3. å®Œæˆï¼
```

**é æœŸçµæœ**ï¼š
- ç§»é™¤é‡è¤‡è¨˜éŒ„
- ç”Ÿæˆæ¸…ç†å¾Œçš„ Excel æª”æ¡ˆ
- é¡¯ç¤ºè™•ç†çµ±è¨ˆè³‡è¨Š

---

## ğŸ’» ç³»çµ±éœ€æ±‚

### æœ€ä½éœ€æ±‚
- **Python**ï¼š3.7 æˆ–ä»¥ä¸Šç‰ˆæœ¬
- **ä½œæ¥­ç³»çµ±**ï¼šWindows / macOS / Linux
- **è¨˜æ†¶é«”**ï¼šå»ºè­° 512MB ä»¥ä¸Š
- **ç£ç¢Ÿç©ºé–“**ï¼š50MBï¼ˆå«ä¾è³´å¥—ä»¶ï¼‰

### æ¨è–¦é…ç½®
- **Python**ï¼š3.9 æˆ–æ›´é«˜ç‰ˆæœ¬
- **è¨˜æ†¶é«”**ï¼š2GB ä»¥ä¸Šï¼ˆè™•ç†å¤§å‹æª”æ¡ˆï¼‰
- **è™•ç†å™¨**ï¼šé›™æ ¸å¿ƒä»¥ä¸Š

### ç›¸ä¾å¥—ä»¶
```
pandas >= 2.0.0      # è³‡æ–™è™•ç†æ ¸å¿ƒ
openpyxl >= 3.1.0    # Excel æª”æ¡ˆè®€å¯«
xlrd (å¯é¸)          # æ”¯æ´èˆŠç‰ˆ .xls æ ¼å¼
```

---

## ğŸ“¦ å®‰è£æŒ‡å—

### æ–¹æ³• 1ï¼šæ¨™æº–å®‰è£ï¼ˆæ¨è–¦ï¼‰

```bash
# 1. è¤‡è£½å°ˆæ¡ˆ
git clone <repository-url>
cd excel-data-cleaner

# 2. å®‰è£ä¾è³´å¥—ä»¶
pip install -r requirements.txt

# 3. é©—è­‰å®‰è£
python -m src.main --version
```

### æ–¹æ³• 2ï¼šä½¿ç”¨è™›æ“¬ç’°å¢ƒï¼ˆæœ€ä½³å¯¦è¸ï¼‰

```bash
# 1. å»ºç«‹è™›æ“¬ç’°å¢ƒ
python3 -m venv venv

# 2. å•Ÿå‹•è™›æ“¬ç’°å¢ƒ
# macOS/Linux:
source venv/bin/activate

# Windows:
venv\Scripts\activate

# 3. å®‰è£ä¾è³´
pip install -r requirements.txt

# 4. ä½¿ç”¨å®Œç•¢å¾Œåœç”¨
deactivate
```

### æ–¹æ³• 3ï¼šæ”¯æ´èˆŠç‰ˆ Excel (.xls)

```bash
# é¡å¤–å®‰è£ xlrd å¥—ä»¶
pip install xlrd

# ç¾åœ¨å¯ä»¥è™•ç† .xls æª”æ¡ˆ
python -m src.main -i old_file.xls -o new_file.xlsx
```

---

## ğŸ“– åŸºæœ¬ä½¿ç”¨

### å‘½ä»¤åˆ—èªæ³•

```bash
python -m src.main -i <è¼¸å…¥æª”æ¡ˆ> -o <è¼¸å‡ºæª”æ¡ˆ> [é¸é …]
```

### å¿…è¦åƒæ•¸

| åƒæ•¸ | ç°¡å¯« | èªªæ˜ | ç¯„ä¾‹ |
|------|------|------|------|
| `--input` | `-i` | è¼¸å…¥ Excel æª”æ¡ˆè·¯å¾‘ | `-i data.xlsx` |
| `--output` | `-o` | è¼¸å‡º Excel æª”æ¡ˆè·¯å¾‘ | `-o clean.xlsx` |

### å¯é¸åƒæ•¸

| åƒæ•¸ | ç°¡å¯« | é è¨­å€¼ | èªªæ˜ |
|------|------|--------|------|
| `--columns` | `-c` | `Date` `Machine No.` | åˆ¤æ–·é‡è¤‡çš„æ¬„ä½ |
| `--keep` | `-k` | `first` | ä¿ç•™ç­–ç•¥ (first/last/none) |
| `--log-level` | - | `INFO` | æ—¥èªŒè©³ç´°ç¨‹åº¦ |
| `--log-file` | - | ç„¡ | æ—¥èªŒè¼¸å‡ºæª”æ¡ˆ |
| `--include-index` | - | False | åŒ…å«ç´¢å¼•æ¬„ä½ |
| `--no-preview` | - | False | ä¸é¡¯ç¤ºé è¦½ |
| `--version` | `-v` | - | é¡¯ç¤ºç‰ˆæœ¬ |
| `--help` | `-h` | - | é¡¯ç¤ºå¹«åŠ© |

### ä½¿ç”¨ç¯„ä¾‹

#### ç¯„ä¾‹ 1ï¼šåŸºæœ¬æ¸…æ´—
```bash
python -m src.main -i input.xlsx -o output.xlsx
```
ä½¿ç”¨é è¨­æ¬„ä½ `Date` å’Œ `Machine No.` åˆ¤æ–·é‡è¤‡ï¼Œä¿ç•™ç¬¬ä¸€ç­†ã€‚

#### ç¯„ä¾‹ 2ï¼šè‡ªè¨‚æ¬„ä½
```bash
python -m src.main -i data.xlsx -o clean.xlsx -c "è¨‚å–®æ—¥æœŸ" "ç”¢å“ç·¨è™Ÿ"
```
ä½¿ç”¨è‡ªè¨‚æ¬„ä½çµ„åˆåˆ¤æ–·é‡è¤‡ã€‚

#### ç¯„ä¾‹ 3ï¼šä¿ç•™æœ€å¾Œä¸€ç­†
```bash
python -m src.main -i data.xlsx -o clean.xlsx -k last
```
æ¯çµ„é‡è¤‡è¨˜éŒ„ä¿ç•™æœ€å¾Œä¸€ç­†ï¼ˆæœ€æ–°çš„ï¼‰ã€‚

#### ç¯„ä¾‹ 4ï¼šç§»é™¤æ‰€æœ‰é‡è¤‡
```bash
python -m src.main -i data.xlsx -o clean.xlsx -k none
```
å®Œå…¨ç§»é™¤é‡è¤‡è¨˜éŒ„ï¼Œåªä¿ç•™å”¯ä¸€è¨˜éŒ„ã€‚

#### ç¯„ä¾‹ 5ï¼šè©³ç´°æ—¥èªŒ
```bash
python -m src.main \
  -i data.xlsx \
  -o clean.xlsx \
  --log-level DEBUG \
  --log-file logs/cleaning.log
```
å•Ÿç”¨ DEBUG æ¨¡å¼ä¸¦å„²å­˜æ—¥èªŒåˆ°æª”æ¡ˆã€‚

---

## ğŸ”§ é€²éšåŠŸèƒ½

### 1. æ—¥èªŒå±¤ç´šæ§åˆ¶

#### å¯ç”¨å±¤ç´š
```
DEBUG    â†’ æœ€è©³ç´°ï¼ˆè¨˜æ†¶é«”ä½¿ç”¨ã€æ¬„ä½é©—è­‰ï¼‰
INFO     â†’ æ¨™æº–è³‡è¨Šï¼ˆé è¨­ï¼‰
WARNING  â†’ è­¦å‘Šè¨Šæ¯
ERROR    â†’ éŒ¯èª¤è¨Šæ¯
CRITICAL â†’ åš´é‡éŒ¯èª¤
```

#### ä½¿ç”¨æ–¹å¼
```bash
# æŸ¥çœ‹è©³ç´°åŸ·è¡Œéç¨‹
python -m src.main -i data.xlsx -o clean.xlsx --log-level DEBUG

# åªçœ‹éŒ¯èª¤
python -m src.main -i data.xlsx -o clean.xlsx --log-level ERROR
```

#### DEBUG æ¨¡å¼é¡å¤–è³‡è¨Š
```
2025-11-29 10:00:00 - DEBUG - æ—¥èªŒç³»çµ±å·²åˆå§‹åŒ–ï¼Œå±¤ç´šï¼šDEBUG
2025-11-29 10:00:01 - DEBUG - æª”æ¡ˆè·¯å¾‘é©—è­‰é€šéï¼š/path/to/input.xlsx
2025-11-29 10:00:01 - DEBUG - è³‡æ–™æ¡†è¨˜æ†¶é«”ä½¿ç”¨ï¼š0.25 MB
2025-11-29 10:00:01 - DEBUG - æ¬„ä½é©—è­‰é€šéï¼š['Date', 'Machine No.']
```

### 2. æ‰¹æ¬¡è™•ç†

#### å»ºç«‹æ‰¹æ¬¡è™•ç†è…³æœ¬
```bash
#!/bin/bash
# batch_clean.sh

# è™•ç†è³‡æ–™å¤¾ä¸­æ‰€æœ‰ Excel æª”æ¡ˆ
for file in data/*.xlsx; do
    filename=$(basename "$file" .xlsx)
    echo "è™•ç†: $filename"

    python -m src.main \
        -i "$file" \
        -o "cleaned/${filename}_clean.xlsx" \
        --no-preview \
        --log-file "logs/${filename}.log"
done

echo "âœ… æ‰¹æ¬¡è™•ç†å®Œæˆï¼"
```

#### åŸ·è¡Œæ‰¹æ¬¡è™•ç†
```bash
chmod +x batch_clean.sh
./batch_clean.sh
```

### 3. è™•ç†å¤§å‹æª”æ¡ˆ

```bash
# é—œé–‰é è¦½ä»¥æå‡æ•ˆèƒ½
python -m src.main \
  -i large_file.xlsx \
  -o cleaned_large.xlsx \
  --no-preview \
  --log-level WARNING
```

**æ•ˆèƒ½æç¤º**ï¼š
- ä½¿ç”¨ `--no-preview` è·³éè³‡æ–™é è¦½
- é™ä½æ—¥èªŒå±¤ç´šåˆ° WARNING æˆ– ERROR
- ç¢ºä¿æœ‰è¶³å¤ çš„ç³»çµ±è¨˜æ†¶é«”

### 4. è‡ªå‹•åŒ–æ’ç¨‹

#### Linux/macOS (cron)
```bash
# ç·¨è¼¯ crontab
crontab -e

# æ¯å¤©å‡Œæ™¨ 2 é»åŸ·è¡Œ
0 2 * * * cd /path/to/project && python -m src.main -i daily.xlsx -o cleaned.xlsx
```

#### Windows (å·¥ä½œæ’ç¨‹å™¨)
1. é–‹å•Ÿã€Œå·¥ä½œæ’ç¨‹å™¨ã€
2. å»ºç«‹åŸºæœ¬å·¥ä½œ
3. è¨­å®šè§¸ç™¼ç¨‹åºï¼ˆæ¯æ—¥ã€æ¯é€±ç­‰ï¼‰
4. å‹•ä½œï¼šå•Ÿå‹•ç¨‹å¼ `python`
5. å¼•æ•¸ï¼š`-m src.main -i data.xlsx -o clean.xlsx`

---

## ğŸ—ï¸ ç¨‹å¼æ¶æ§‹

### å°ˆæ¡ˆçµæ§‹

```
excel-data-cleaner/
â”‚
â”œâ”€â”€ Data Clean.py               # èˆŠç‰ˆå–®æª”ç¨‹å¼ï¼ˆv1.0ï¼‰
â”‚
â”œâ”€â”€ src/                        # æ¨¡çµ„åŒ–ç‰ˆæœ¬ï¼ˆv2.0ï¼‰
â”‚   â”œâ”€â”€ __init__.py            # å¥—ä»¶åˆå§‹åŒ–
â”‚   â”œâ”€â”€ main.py                # ä¸»ç¨‹å¼å…¥å£ï¼ˆå”èª¿è€…ï¼‰
â”‚   â”œâ”€â”€ cli.py                 # å‘½ä»¤åˆ—ä»‹é¢
â”‚   â””â”€â”€ data_processor.py      # è³‡æ–™è™•ç†æ ¸å¿ƒ
â”‚
â”œâ”€â”€ utils/                      # å·¥å…·æ¨¡çµ„
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ logger.py              # æ—¥èªŒç³»çµ±
â”‚   â””â”€â”€ validators.py          # é©—è­‰å·¥å…·
â”‚
â”œâ”€â”€ tests/                      # å–®å…ƒæ¸¬è©¦
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ test_validators.py
â”‚   â””â”€â”€ test_data_processor.py
â”‚
â”œâ”€â”€ requirements.txt            # ä¾è³´å¥—ä»¶æ¸…å–®
â”œâ”€â”€ README.md                  # å°ˆæ¡ˆèªªæ˜
â”œâ”€â”€ CLAUDE.md                  # Claude Code é–‹ç™¼æŒ‡å—
â”œâ”€â”€ CLI_GUIDE.md               # CLI ä½¿ç”¨æŒ‡å—
â”œâ”€â”€ BUG_REPORT.md              # Bug åˆ†æå ±å‘Š
â””â”€â”€ ä½¿ç”¨æ‰‹å†Š.md                # æœ¬æ–‡ä»¶
```

### æ¨¡çµ„è·è²¬

#### src/main.py - ä¸»ç¨‹å¼
- **è·è²¬**ï¼šå”èª¿å„æ¨¡çµ„åŸ·è¡Œæµç¨‹
- **åŠŸèƒ½**ï¼š
  - å‘¼å« CLI è§£æå™¨
  - åˆå§‹åŒ–æ—¥èªŒç³»çµ±
  - æ§åˆ¶è³‡æ–™æµå‹•
  - çµ±ä¸€éŒ¯èª¤è™•ç†

#### src/cli.py - å‘½ä»¤åˆ—ä»‹é¢
- **è·è²¬**ï¼šè§£æå‘½ä»¤åˆ—åƒæ•¸
- **åŠŸèƒ½**ï¼š
  - åƒæ•¸é©—è­‰
  - é è¨­å€¼è¨­å®š
  - å¹«åŠ©è¨Šæ¯ç”Ÿæˆ

#### src/data_processor.py - è³‡æ–™è™•ç†
- **è·è²¬**ï¼šæ ¸å¿ƒæ¥­å‹™é‚è¼¯
- **åŠŸèƒ½**ï¼š
  - Excel æª”æ¡ˆè®€å–
  - é‡è¤‡è¨˜éŒ„ç§»é™¤
  - Excel æª”æ¡ˆå„²å­˜

#### utils/logger.py - æ—¥èªŒç³»çµ±
- **è·è²¬**ï¼šé›†ä¸­å¼æ—¥èªŒç®¡ç†
- **åŠŸèƒ½**ï¼š
  - æ—¥èªŒæ ¼å¼è¨­å®š
  - å¤šè¼¸å‡ºæ”¯æ´ï¼ˆçµ‚ç«¯æ©Ÿ + æª”æ¡ˆï¼‰
  - ç›®éŒ„è‡ªå‹•å»ºç«‹

#### utils/validators.py - é©—è­‰å·¥å…·
- **è·è²¬**ï¼šè¼¸å…¥é©—è­‰
- **åŠŸèƒ½**ï¼š
  - æª”æ¡ˆè·¯å¾‘é©—è­‰
  - DataFrame æ¬„ä½é©—è­‰
  - å‹å–„éŒ¯èª¤è¨Šæ¯

---

## ğŸ“Š æµç¨‹åœ–è§£

### ä¸»è¦åŸ·è¡Œæµç¨‹åœ–

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ä½¿ç”¨è€…åŸ·è¡Œå‘½ä»¤                              â”‚
â”‚  python -m src.main -i input.xlsx -o output.xlsx -c Date ID     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ­¥é©Ÿ 1: CLI åƒæ•¸è§£æ                     [src/cli.py]          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  parse_arguments()                                    â”‚      â”‚
â”‚  â”‚  â”œâ”€ å¿…è¦: input_file âœ“                               â”‚      â”‚
â”‚  â”‚  â”œâ”€ å¿…è¦: output_file âœ“                              â”‚      â”‚
â”‚  â”‚  â”œâ”€ å¯é¸: columns = ['Date', 'ID']                  â”‚      â”‚
â”‚  â”‚  â”œâ”€ å¯é¸: keep = 'first'                            â”‚      â”‚
â”‚  â”‚  â””â”€ å¯é¸: log_level = 'INFO'                        â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ­¥é©Ÿ 2: æ—¥èªŒç³»çµ±åˆå§‹åŒ–                [utils/logger.py]        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  setup_logging(level='INFO', log_file=None)          â”‚      â”‚
â”‚  â”‚  â”œâ”€ å»ºç«‹ Console Handler â†’ çµ‚ç«¯æ©Ÿè¼¸å‡º               â”‚      â”‚
â”‚  â”‚  â”œâ”€ å»ºç«‹ File Handler (å¯é¸) â†’ æª”æ¡ˆè¼¸å‡º âœ¨          â”‚      â”‚
â”‚  â”‚  â”‚   â””â”€ mkdir logs/ (è‡ªå‹•å»ºç«‹ç›®éŒ„) âœ¨               â”‚      â”‚
â”‚  â”‚  â””â”€ è¨­å®šæ ¼å¼: æ™‚é–“ - å±¤ç´š - è¨Šæ¯                   â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ­¥é©Ÿ 3: è·¯å¾‘è§£æèˆ‡é©—è­‰                    [src/main.py]        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  input_path = Path(args.input).resolve()             â”‚      â”‚
â”‚  â”‚  output_path = Path(args.output).resolve()           â”‚      â”‚
â”‚  â”‚                                                       â”‚      â”‚
â”‚  â”‚  â“ input_path == output_path?                      â”‚      â”‚
â”‚  â”‚     â”œâ”€ YES â†’ âŒ ERROR è¿”å› 1 âœ¨                      â”‚      â”‚
â”‚  â”‚     â””â”€ NO  â†’ âœ… ç¹¼çºŒ                                 â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ­¥é©Ÿ 4: è®€å– Excel æª”æ¡ˆ            [src/data_processor.py]     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  load_excel_data(input_path)                         â”‚      â”‚
â”‚  â”‚  â”‚                                                    â”‚      â”‚
â”‚  â”‚  â”œâ”€ validate_file_path() [utils/validators.py]      â”‚      â”‚
â”‚  â”‚  â”‚   â””â”€ â“ æª”æ¡ˆå­˜åœ¨? âœ…/âŒ                           â”‚      â”‚
â”‚  â”‚  â”‚                                                    â”‚      â”‚
â”‚  â”‚  â”œâ”€ æª¢æŸ¥å‰¯æª”å âœ¨                                    â”‚      â”‚
â”‚  â”‚  â”‚   â”œâ”€ .xls  â†’ pd.read_excel(engine='xlrd')        â”‚      â”‚
â”‚  â”‚  â”‚   â”œâ”€ .xlsx â†’ pd.read_excel(engine='openpyxl')    â”‚      â”‚
â”‚  â”‚  â”‚   â””â”€ å…¶ä»–  â†’ âŒ ValueError                        â”‚      â”‚
â”‚  â”‚  â”‚                                                    â”‚      â”‚
â”‚  â”‚  â”œâ”€ â“ DataFrame ç‚ºç©º? â†’ âŒ ValueError              â”‚      â”‚
â”‚  â”‚  â”‚                                                    â”‚      â”‚
â”‚  â”‚  â””â”€ âœ… è¿”å› DataFrame (1,500 ç­†è¨˜éŒ„)                â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ­¥é©Ÿ 5: é¡¯ç¤ºè³‡æ–™é è¦½ (å¯é¸)              [src/main.py]         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  if not args.no_preview:                             â”‚      â”‚
â”‚  â”‚      print(original_data.head())                     â”‚      â”‚
â”‚  â”‚                                                       â”‚      â”‚
â”‚  â”‚  è¼¸å‡ºç¯„ä¾‹:                                            â”‚      â”‚
â”‚  â”‚       Date  Machine No. Product  Quantity            â”‚      â”‚
â”‚  â”‚  0  2025-01-01    M001      A        10              â”‚      â”‚
â”‚  â”‚  1  2025-01-01    M001      A        10  â† é‡è¤‡      â”‚      â”‚
â”‚  â”‚  2  2025-01-02    M002      B        20              â”‚      â”‚
â”‚  â”‚  3  2025-01-02    M003      C        30              â”‚      â”‚
â”‚  â”‚  4  2025-01-03    M001      D        15              â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ­¥é©Ÿ 6: ç§»é™¤é‡è¤‡è¨˜éŒ„              [src/data_processor.py]      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  remove_duplicate_records(df, columns, keep)         â”‚      â”‚
â”‚  â”‚  â”‚                                                    â”‚      â”‚
â”‚  â”‚  â”œâ”€ validate_columns() [utils/validators.py]        â”‚      â”‚
â”‚  â”‚  â”‚   â”œâ”€ â“ 'Date' in df.columns? âœ…                 â”‚      â”‚
â”‚  â”‚  â”‚   â”œâ”€ â“ 'ID' in df.columns? âœ…                   â”‚      â”‚
â”‚  â”‚  â”‚   â””â”€ å¦‚æœç¼ºå¤± â†’ âŒ ValueError + é¡¯ç¤ºå¯ç”¨æ¬„ä½     â”‚      â”‚
â”‚  â”‚  â”‚                                                    â”‚      â”‚
â”‚  â”‚  â”œâ”€ df.drop_duplicates(                              â”‚      â”‚
â”‚  â”‚  â”‚       subset=['Date', 'ID'],                      â”‚      â”‚
â”‚  â”‚  â”‚       keep='first',      â† CLI çš„ 'none' â†’ False â”‚      â”‚
â”‚  â”‚  â”‚       ignore_index=True  â† é‡ç½®ç´¢å¼•              â”‚      â”‚
â”‚  â”‚  â”‚   )                                               â”‚      â”‚
â”‚  â”‚  â”‚                                                    â”‚      â”‚
â”‚  â”‚  â””â”€ è¨ˆç®—çµ±è¨ˆ:                                        â”‚      â”‚
â”‚  â”‚      ç§»é™¤ 150 ç­† (10.00%)                            â”‚      â”‚
â”‚  â”‚      å‰©é¤˜ 1,350 ç­†                                   â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ­¥é©Ÿ 7: é¡¯ç¤ºæ¸…ç†å¾Œé è¦½ (å¯é¸)            [src/main.py]         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  print(cleaned_data.head())                          â”‚      â”‚
â”‚  â”‚                                                       â”‚      â”‚
â”‚  â”‚       Date  Machine No. Product  Quantity            â”‚      â”‚
â”‚  â”‚  0  2025-01-01    M001      A        10  â† ä¿ç•™ç¬¬ä¸€ç­†â”‚      â”‚
â”‚  â”‚  1  2025-01-02    M002      B        20              â”‚      â”‚
â”‚  â”‚  2  2025-01-02    M003      C        30              â”‚      â”‚
â”‚  â”‚  3  2025-01-03    M001      D        15              â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ­¥é©Ÿ 8: å„²å­˜æ¸…ç†å¾Œçš„è³‡æ–™          [src/data_processor.py]      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  save_excel_data(df, output_path, include_index)     â”‚      â”‚
â”‚  â”‚  â”‚                                                    â”‚      â”‚
â”‚  â”‚  â”œâ”€ output_path.parent.mkdir()  â† å»ºç«‹ç›®éŒ„          â”‚      â”‚
â”‚  â”‚  â”‚                                                    â”‚      â”‚
â”‚  â”‚  â”œâ”€ df.to_excel(                                     â”‚      â”‚
â”‚  â”‚  â”‚       output_path,                                â”‚      â”‚
â”‚  â”‚  â”‚       index=False,                                â”‚      â”‚
â”‚  â”‚  â”‚       engine='openpyxl'                           â”‚      â”‚
â”‚  â”‚  â”‚   )                                               â”‚      â”‚
â”‚  â”‚  â”‚                                                    â”‚      â”‚
â”‚  â”‚  â””â”€ é¡¯ç¤ºæª”æ¡ˆå¤§å°: 0.15 MB                           â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    âœ… å®Œæˆï¼è¿”å›ç‹€æ…‹ç¢¼ 0                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ¨¡çµ„äº’å‹•é—œä¿‚åœ–

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         src/main.py                          â”‚
â”‚                    (ä¸»ç¨‹å¼ - å”èª¿è€…)                         â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  main()                                           â”‚      â”‚
â”‚  â”‚    â†“                                              â”‚      â”‚
â”‚  â”‚  å‘¼å«æ‰€æœ‰å…¶ä»–æ¨¡çµ„                                  â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚            â”‚            â”‚          â”‚
        â–¼            â–¼            â–¼          â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚src/    â”‚  â”‚src/     â”‚  â”‚utils/   â”‚  â”‚utils/    â”‚
   â”‚cli.py  â”‚  â”‚data_    â”‚  â”‚logger   â”‚  â”‚validatorsâ”‚
   â”‚        â”‚  â”‚processorâ”‚  â”‚.py      â”‚  â”‚.py       â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚            â”‚            â”‚             â”‚
       â”‚            â”‚            â”‚             â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚  pandas       â”‚
                â”‚  openpyxl     â”‚
                â”‚  xlrd (å¯é¸)  â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  å¤–éƒ¨ä¾è³´å¥—ä»¶
```

### è³‡æ–™æµè½‰æ›åœ–

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      è³‡æ–™å½¢æ…‹è½‰æ›                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Excel æª”æ¡ˆ (.xlsx/.xls)
    â”‚
    â”‚ [pd.read_excel(engine=...)]
    â–¼
pandas.DataFrame (åŸå§‹)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Date â”‚ Machine â”‚ Productâ”‚
â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0101 â”‚  M001   â”‚   A    â”‚
â”‚ 0101 â”‚  M001   â”‚   A    â”‚ â† é‡è¤‡
â”‚ 0102 â”‚  M002   â”‚   B    â”‚
â”‚ 0102 â”‚  M003   â”‚   C    â”‚
â”‚ 0103 â”‚  M001   â”‚   D    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â”‚ [validate_columns()]
    â–¼
pandas.DataFrame (å·²é©—è­‰)
    â”‚
    â”‚ [drop_duplicates(subset, keep, ignore_index)]
    â–¼
pandas.DataFrame (å·²æ¸…æ´—)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Date â”‚ Machine â”‚ Productâ”‚
â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0101 â”‚  M001   â”‚   A    â”‚ â† ä¿ç•™ç¬¬ä¸€ç­†
â”‚ 0102 â”‚  M002   â”‚   B    â”‚
â”‚ 0102 â”‚  M003   â”‚   C    â”‚
â”‚ 0103 â”‚  M001   â”‚   D    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â”‚ [df.to_excel(engine='openpyxl')]
    â–¼
Excel æª”æ¡ˆ (.xlsx)
```

### éŒ¯èª¤è™•ç†æµç¨‹åœ–

```
                    åŸ·è¡Œç¨‹å¼
                       â”‚
                       â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚    try: åŸ·è¡Œä¸»è¦æµç¨‹          â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚              â”‚              â”‚
        â–¼              â–¼              â–¼
   FileNotFoundError ValueError  PermissionError
        â”‚              â”‚              â”‚
        â–¼              â–¼              â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚æª”æ¡ˆéŒ¯èª¤â”‚    â”‚æ•¸å€¼éŒ¯èª¤â”‚    â”‚æ¬Šé™éŒ¯èª¤â”‚
    â”‚        â”‚    â”‚        â”‚    â”‚        â”‚
    â”‚logging â”‚    â”‚logging â”‚    â”‚logging â”‚
    â”‚.error  â”‚    â”‚.error  â”‚    â”‚.error  â”‚
    â”‚        â”‚    â”‚        â”‚    â”‚        â”‚
    â”‚è¿”å› 1  â”‚    â”‚è¿”å› 1  â”‚    â”‚è¿”å› 1  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚              â”‚              â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
                  ç¨‹å¼çµæŸ

ç‰¹æ®Šæƒ…æ³:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ KeyboardInterrupt   â”‚
â”‚ (Ctrl+C)            â”‚
â”‚                     â”‚
â”‚ logging.warning()   â”‚
â”‚ è¿”å› 130            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Keep Strategy æ±ºç­–æ¨¹

```
ä½¿ç”¨è€…è¼¸å…¥: -k <ç­–ç•¥>
        â”‚
        â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”
    â”‚ CLI   â”‚
    â”‚ è§£æ  â”‚
    â””â”€â”€â”€â”¬â”€â”€â”€â”˜
        â”‚
    â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                 â”‚
    â–¼                                 â–¼
args.keep                      Python å…§éƒ¨è½‰æ›
(å­—ä¸²)                          (å‹åˆ¥)
    â”‚                                 â”‚
    â”œâ”€ "first"  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’  'first'
    â”‚                                 â”‚
    â”œâ”€ "last"   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’  'last'
    â”‚                                 â”‚
    â””â”€ "none"   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’  False
                                      â”‚
                                      â–¼
                        pandas.drop_duplicates(keep=?)
                                      â”‚
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚             â”‚             â”‚
                        â–¼             â–¼             â–¼
                    keep='first'  keep='last'   keep=False
                        â”‚             â”‚             â”‚
                        â–¼             â–¼             â–¼
                    ä¿ç•™ç¬¬ä¸€ç­†     ä¿ç•™æœ€å¾Œç­†     å…¨éƒ¨ç§»é™¤

ç¯„ä¾‹è³‡æ–™: [A, A, A, B, B]

çµæœ:
keep='first'  â†’ [A, B]        (ä¿ç•™æ¯çµ„çš„ç¬¬ 1 ç­†)
keep='last'   â†’ [A, B]        (ä¿ç•™æ¯çµ„çš„æœ€å¾Œ 1 ç­†)
keep=False    â†’ []            (å…¨éƒ¨éƒ½æ˜¯é‡è¤‡ï¼Œå…¨ç§»é™¤)
```

---

## ğŸ“š API åƒè€ƒ

### è³‡æ–™è™•ç†å™¨ (data_processor.py)

#### load_excel_data()

```python
def load_excel_data(file_path: Path) -> pd.DataFrame
```

**åŠŸèƒ½**ï¼šå¾ Excel æª”æ¡ˆè®€å–è³‡æ–™

**åƒæ•¸**ï¼š
- `file_path` (Path): Excel æª”æ¡ˆè·¯å¾‘

**è¿”å›**ï¼š
- `pd.DataFrame`: è®€å–çš„è³‡æ–™æ¡†

**æ‹‹å‡ºç•°å¸¸**ï¼š
- `FileNotFoundError`: æª”æ¡ˆä¸å­˜åœ¨
- `ValueError`: æª”æ¡ˆç‚ºç©ºæˆ–æ ¼å¼ä¸æ”¯æ´

**ç¯„ä¾‹**ï¼š
```python
from pathlib import Path
from src.data_processor import load_excel_data

df = load_excel_data(Path("data.xlsx"))
print(f"è®€å–äº† {len(df)} ç­†è¨˜éŒ„")
```

**ç‰¹æ®ŠåŠŸèƒ½**ï¼š
- âœ¨ è‡ªå‹•é¸æ“‡å¼•æ“ï¼ˆ.xls â†’ xlrd, .xlsx â†’ openpyxlï¼‰
- âœ¨ é©—è­‰æª”æ¡ˆæ ¼å¼
- âœ¨ é¡¯ç¤ºè¨˜æ†¶é«”ä½¿ç”¨ï¼ˆDEBUG æ¨¡å¼ï¼‰

---

#### remove_duplicate_records()

```python
def remove_duplicate_records(
    data_frame: pd.DataFrame,
    duplicate_check_columns: List[str],
    keep_strategy: Literal['first', 'last', False] = 'first'
) -> pd.DataFrame
```

**åŠŸèƒ½**ï¼šç§»é™¤é‡è¤‡è¨˜éŒ„

**åƒæ•¸**ï¼š
- `data_frame` (pd.DataFrame): åŸå§‹è³‡æ–™æ¡†
- `duplicate_check_columns` (List[str]): ç”¨æ–¼æª¢æŸ¥é‡è¤‡çš„æ¬„ä½åˆ—è¡¨
- `keep_strategy` (Literal['first', 'last', False]): ä¿ç•™ç­–ç•¥
  - `'first'`: ä¿ç•™ç¬¬ä¸€ç­†ï¼ˆé è¨­ï¼‰
  - `'last'`: ä¿ç•™æœ€å¾Œä¸€ç­†
  - `False`: ç§»é™¤æ‰€æœ‰é‡è¤‡

**è¿”å›**ï¼š
- `pd.DataFrame`: æ¸…ç†å¾Œçš„è³‡æ–™æ¡†

**æ‹‹å‡ºç•°å¸¸**ï¼š
- `ValueError`: æŒ‡å®šçš„æ¬„ä½ä¸å­˜åœ¨

**ç¯„ä¾‹**ï¼š
```python
cleaned_df = remove_duplicate_records(
    df,
    ['Date', 'Machine No.'],
    'first'
)
```

---

#### save_excel_data()

```python
def save_excel_data(
    data_frame: pd.DataFrame,
    output_file_path: Path,
    include_index: bool = False
) -> None
```

**åŠŸèƒ½**ï¼šå„²å­˜è³‡æ–™æ¡†ç‚º Excel æª”æ¡ˆ

**åƒæ•¸**ï¼š
- `data_frame` (pd.DataFrame): è¦å„²å­˜çš„è³‡æ–™æ¡†
- `output_file_path` (Path): è¼¸å‡ºæª”æ¡ˆè·¯å¾‘
- `include_index` (bool): æ˜¯å¦åŒ…å«ç´¢å¼•ï¼ˆé è¨­ Falseï¼‰

**è¿”å›**ï¼š
- None

**æ‹‹å‡ºç•°å¸¸**ï¼š
- `PermissionError`: æ²’æœ‰å¯«å…¥æ¬Šé™
- `OSError`: ç£ç¢Ÿç©ºé–“ä¸è¶³

**ç¯„ä¾‹**ï¼š
```python
save_excel_data(cleaned_df, Path("output.xlsx"))
```

---

### é©—è­‰å·¥å…· (validators.py)

#### validate_file_path()

```python
def validate_file_path(
    file_path: Path,
    must_exist: bool = True
) -> None
```

**åŠŸèƒ½**ï¼šé©—è­‰æª”æ¡ˆè·¯å¾‘

**åƒæ•¸**ï¼š
- `file_path` (Path): è¦é©—è­‰çš„è·¯å¾‘
- `must_exist` (bool): æ˜¯å¦è¦æ±‚æª”æ¡ˆå¿…é ˆå­˜åœ¨ï¼ˆé è¨­ Trueï¼‰

**æ‹‹å‡ºç•°å¸¸**ï¼š
- `FileNotFoundError`: æª”æ¡ˆä¸å­˜åœ¨
- `ValueError`: è·¯å¾‘ä¸æ˜¯æœ‰æ•ˆçš„æª”æ¡ˆ

---

#### validate_columns()

```python
def validate_columns(
    data_frame: pd.DataFrame,
    required_columns: List[str]
) -> None
```

**åŠŸèƒ½**ï¼šé©—è­‰è³‡æ–™æ¡†åŒ…å«å¿…è¦æ¬„ä½

**åƒæ•¸**ï¼š
- `data_frame` (pd.DataFrame): è¦é©—è­‰çš„è³‡æ–™æ¡†
- `required_columns` (List[str]): å¿…é ˆå­˜åœ¨çš„æ¬„ä½åˆ—è¡¨

**æ‹‹å‡ºç•°å¸¸**ï¼š
- `ValueError`: ç¼ºå°‘å¿…è¦æ¬„ä½ï¼ˆæœƒé¡¯ç¤ºå¯ç”¨æ¬„ä½ï¼‰

**ç¯„ä¾‹**ï¼š
```python
validate_columns(df, ['Date', 'Machine No.'])
```

---

### æ—¥èªŒå·¥å…· (logger.py)

#### setup_logging()

```python
def setup_logging(
    log_level: str = "INFO",
    log_file: Optional[Path] = None
) -> None
```

**åŠŸèƒ½**ï¼šè¨­å®šæ—¥èªŒç³»çµ±

**åƒæ•¸**ï¼š
- `log_level` (str): æ—¥èªŒå±¤ç´šï¼ˆDEBUG/INFO/WARNING/ERROR/CRITICALï¼‰
- `log_file` (Optional[Path]): æ—¥èªŒæª”æ¡ˆè·¯å¾‘ï¼ˆNone = åªè¼¸å‡ºåˆ°çµ‚ç«¯æ©Ÿï¼‰

**ç‰¹æ®ŠåŠŸèƒ½**ï¼š
- âœ¨ è‡ªå‹•å»ºç«‹æ—¥èªŒç›®éŒ„
- åŒæ™‚è¼¸å‡ºåˆ°çµ‚ç«¯æ©Ÿå’Œæª”æ¡ˆ
- UTF-8 ç·¨ç¢¼æ”¯æ´ä¸­æ–‡

---

## â“ å¸¸è¦‹å•é¡Œ

### Q1: å¦‚ä½•è™•ç†ä¸­æ–‡æ¬„ä½åç¨±ï¼Ÿ

**A**: ç›´æ¥ä½¿ç”¨å¼•è™ŸåŒ…åœå³å¯

```bash
python -m src.main -i data.xlsx -o clean.xlsx -c "è¨‚å–®æ—¥æœŸ" "ç”¢å“ç·¨è™Ÿ"
```

### Q2: å¦‚ä½•æ‰¹æ¬¡è™•ç†å¤šå€‹æª”æ¡ˆï¼Ÿ

**A**: å»ºç«‹ shell è…³æœ¬

```bash
#!/bin/bash
for file in data/*.xlsx; do
    output="cleaned/$(basename "$file")"
    python -m src.main -i "$file" -o "$output" --no-preview
done
```

### Q3: æ¬„ä½åç¨±æœ‰ç©ºæ ¼æ€éº¼è¾¦ï¼Ÿ

**A**: ä½¿ç”¨å¼•è™ŸåŒ…åœ

```bash
python -m src.main -i data.xlsx -o clean.xlsx -c "Machine No." "Product ID"
```

### Q4: å¦‚ä½•çŸ¥é“æœ‰å“ªäº›æ¬„ä½å¯ç”¨ï¼Ÿ

**A**: ä½¿ç”¨ DEBUG å±¤ç´šæŸ¥çœ‹

```bash
python -m src.main -i data.xlsx -o clean.xlsx --log-level DEBUG
# æœƒé¡¯ç¤ºï¼šè³‡æ–™æ¬„ä½ï¼š['Date', 'Machine No.', 'Product', ...]
```

### Q5: ç¨‹å¼åŸ·è¡Œå¤ªæ…¢æ€éº¼è¾¦ï¼Ÿ

**A**: é—œé–‰é è¦½ä¸¦é™ä½æ—¥èªŒå±¤ç´š

```bash
python -m src.main -i large.xlsx -o clean.xlsx --no-preview --log-level WARNING
```

### Q6: å¦‚ä½•è™•ç†èˆŠç‰ˆ .xls æª”æ¡ˆï¼Ÿ

**A**: å®‰è£ xlrd å¥—ä»¶

```bash
pip install xlrd
python -m src.main -i old_file.xls -o new_file.xlsx
```

### Q7: å¯ä»¥åœ¨è¼¸å‡ºä¸­åŒ…å«è¡Œè™Ÿå—ï¼Ÿ

**A**: ä½¿ç”¨ `--include-index` åƒæ•¸

```bash
python -m src.main -i data.xlsx -o output.xlsx --include-index
```

### Q8: å¦‚ä½•è‡ªå‹•åŒ–æ¯æ—¥åŸ·è¡Œï¼Ÿ

**A**: ä½¿ç”¨ cronï¼ˆLinux/macOSï¼‰æˆ–å·¥ä½œæ’ç¨‹å™¨ï¼ˆWindowsï¼‰

```bash
# crontab ç¯„ä¾‹
0 2 * * * cd /path/to/project && python -m src.main -i daily.xlsx -o cleaned.xlsx
```

---

## ğŸ”§ æ•…éšœæ’é™¤

### å•é¡Œ 1: ModuleNotFoundError: No module named 'src'

**åŸå› **ï¼šä¸åœ¨å°ˆæ¡ˆæ ¹ç›®éŒ„åŸ·è¡Œ

**è§£æ±ºæ–¹æ³•**ï¼š
```bash
# ç¢ºèªç›®å‰ä½ç½®
pwd

# åˆ‡æ›åˆ°å°ˆæ¡ˆæ ¹ç›®éŒ„
cd /Users/richpei/myproject/Code/Python/Cursor

# ç¢ºèª src ç›®éŒ„å­˜åœ¨
ls -la | grep src
```

---

### å•é¡Œ 2: ModuleNotFoundError: No module named 'pandas'

**åŸå› **ï¼šæœªå®‰è£ä¾è³´å¥—ä»¶

**è§£æ±ºæ–¹æ³•**ï¼š
```bash
pip install -r requirements.txt
```

---

### å•é¡Œ 3: è³‡æ–™ä¸­ç¼ºå°‘ä»¥ä¸‹å¿…è¦æ¬„ä½

**éŒ¯èª¤è¨Šæ¯**ï¼š
```
ERROR - è³‡æ–™ä¸­ç¼ºå°‘ä»¥ä¸‹å¿…è¦æ¬„ä½ï¼š['MachineNo']
ERROR - å¯ç”¨çš„æ¬„ä½æœ‰ï¼š['Date', 'Machine No.', 'Product']
```

**åŸå› **ï¼šæ¬„ä½åç¨±æ‹¼å¯«éŒ¯èª¤æˆ–å¤§å°å¯«ä¸ç¬¦

**è§£æ±ºæ–¹æ³•**ï¼š
```bash
# å…ˆç”¨ DEBUG æ¨¡å¼æŸ¥çœ‹æ­£ç¢ºæ¬„ä½åç¨±
python -m src.main -i data.xlsx -o clean.xlsx --log-level DEBUG

# ä½¿ç”¨æ­£ç¢ºçš„æ¬„ä½åç¨±ï¼ˆæ³¨æ„ç©ºæ ¼ï¼‰
python -m src.main -i data.xlsx -o clean.xlsx -c "Machine No."
```

---

### å•é¡Œ 4: éŒ¯èª¤ï¼šè¼¸å…¥å’Œè¼¸å‡ºæª”æ¡ˆä¸èƒ½ç›¸åŒ

**éŒ¯èª¤è¨Šæ¯**ï¼š
```
ERROR - éŒ¯èª¤ï¼šè¼¸å…¥å’Œè¼¸å‡ºæª”æ¡ˆä¸èƒ½ç›¸åŒ
ERROR - é€™æœƒå°è‡´åŸå§‹è³‡æ–™è¢«è¦†è“‹ï¼Œè«‹æŒ‡å®šä¸åŒçš„è¼¸å‡ºæª”æ¡ˆ
```

**åŸå› **ï¼šâœ¨ æ–°å¢çš„å®‰å…¨æª¢æŸ¥ï¼Œé˜²æ­¢è¦†è“‹åŸå§‹è³‡æ–™

**è§£æ±ºæ–¹æ³•**ï¼š
```bash
# ä½¿ç”¨ä¸åŒçš„è¼¸å‡ºæª”å
python -m src.main -i data.xlsx -o data_cleaned.xlsx
```

---

### å•é¡Œ 5: è®€å– .xls æª”æ¡ˆéœ€è¦å®‰è£ xlrd å¥—ä»¶

**éŒ¯èª¤è¨Šæ¯**ï¼š
```
ValueError: è®€å– .xls æª”æ¡ˆéœ€è¦å®‰è£ xlrd å¥—ä»¶
è«‹åŸ·è¡Œï¼špip install xlrd
```

**åŸå› **ï¼šâœ¨ ç¨‹å¼åµæ¸¬åˆ° .xls æ ¼å¼ä½†ç¼ºå°‘ xlrd

**è§£æ±ºæ–¹æ³•**ï¼š
```bash
pip install xlrd
```

---

### å•é¡Œ 6: PermissionError

**éŒ¯èª¤è¨Šæ¯**ï¼š
```
ERROR - æ¬Šé™éŒ¯èª¤ï¼šæ²’æœ‰æª”æ¡ˆå¯«å…¥æ¬Šé™
```

**å¯èƒ½åŸå› **ï¼š
1. è¼¸å‡ºæª”æ¡ˆè¢« Excel æˆ–å…¶ä»–ç¨‹å¼é–‹å•Ÿ
2. æ²’æœ‰è³‡æ–™å¤¾å¯«å…¥æ¬Šé™
3. ç£ç¢Ÿç©ºé–“ä¸è¶³

**è§£æ±ºæ–¹æ³•**ï¼š
```bash
# 1. é—œé–‰æ­£åœ¨é–‹å•Ÿè¼¸å‡ºæª”æ¡ˆçš„ç¨‹å¼
# 2. æª¢æŸ¥æ¬Šé™
ls -la output.xlsx

# 3. æª¢æŸ¥ç£ç¢Ÿç©ºé–“
df -h
```

---

### å•é¡Œ 7: ç¨‹å¼åŸ·è¡Œç„¡åæ‡‰

**å¯èƒ½åŸå› **ï¼šè™•ç†å¤§å‹æª”æ¡ˆ

**è§£æ±ºæ–¹æ³•**ï¼š
```bash
# å•Ÿç”¨ DEBUG æŸ¥çœ‹é€²åº¦
python -m src.main -i large.xlsx -o clean.xlsx --log-level DEBUG

# æˆ–é—œé–‰é è¦½åŠ é€Ÿ
python -m src.main -i large.xlsx -o clean.xlsx --no-preview
```

---

## ğŸ’¡ æœ€ä½³å¯¦è¸

### 1. è³‡æ–™å‚™ä»½

**å§‹çµ‚å‚™ä»½åŸå§‹è³‡æ–™**

```bash
# å…ˆè¤‡è£½æª”æ¡ˆ
cp original.xlsx original_backup.xlsx

# å†é€²è¡Œæ¸…æ´—
python -m src.main -i original.xlsx -o cleaned.xlsx
```

### 2. ä½¿ç”¨æœ‰æ„ç¾©çš„æª”å

```bash
# âŒ ä¸å¥½çš„å‘½å
python -m src.main -i data.xlsx -o out.xlsx

# âœ… å¥½çš„å‘½åï¼ˆåŒ…å«æ—¥æœŸï¼‰
python -m src.main -i sales_2025-01.xlsx -o sales_2025-01_cleaned.xlsx
```

### 3. ä¿ç•™è™•ç†æ—¥èªŒ

```bash
# å»ºç«‹æ—¥èªŒç›®éŒ„
mkdir -p logs

# ä½¿ç”¨æ—¥æœŸæ™‚é–“å‘½åæ—¥èªŒ
python -m src.main \
  -i data.xlsx \
  -o clean.xlsx \
  --log-file "logs/clean_$(date +%Y%m%d_%H%M%S).log"
```

### 4. å…ˆå°ç¯„åœæ¸¬è©¦

```bash
# 1. å…ˆç”¨æ¸¬è©¦è³‡æ–™é©—è­‰
python -m src.main -i test_small.xlsx -o test_output.xlsx --log-level DEBUG

# 2. ç¢ºèªç„¡èª¤å¾Œå†è™•ç†å®Œæ•´è³‡æ–™
python -m src.main -i full_data.xlsx -o full_cleaned.xlsx
```

### 5. ä½¿ç”¨è™›æ“¬ç’°å¢ƒ

```bash
# é¿å…å¥—ä»¶ç‰ˆæœ¬è¡çª
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt
```

### 6. å®šæœŸæ¸…ç†æ—¥èªŒ

```bash
# åˆªé™¤ 30 å¤©å‰çš„æ—¥èªŒ
find logs/ -name "*.log" -mtime +30 -delete
```

### 7. ç‰ˆæœ¬æ§åˆ¶

```bash
# åŠ å…¥ .gitignore
echo "*.xlsx" >> .gitignore
echo "*.xls" >> .gitignore
echo "logs/" >> .gitignore

# åªè¿½è¹¤ç¨‹å¼ç¢¼
git add src/ utils/ tests/ requirements.txt
```

---

## ğŸ“ æŠ€è¡“æ”¯æ´

### å•é¡Œå›å ±

å¦‚ç™¼ç¾ Bug æˆ–æœ‰åŠŸèƒ½å»ºè­°ï¼Œè«‹ï¼š

1. æŸ¥é–± `BUG_REPORT.md` ç¢ºèªæ˜¯å¦ç‚ºå·²çŸ¥å•é¡Œ
2. å»ºç«‹ Issue ä¸¦æä¾›ï¼š
   - éŒ¯èª¤è¨Šæ¯
   - åŸ·è¡Œå‘½ä»¤
   - Python ç‰ˆæœ¬
   - ä½œæ¥­ç³»çµ±

### æ–‡ä»¶

- **å°ˆæ¡ˆèªªæ˜**ï¼š`README.md`
- **CLI ä½¿ç”¨**ï¼š`CLI_GUIDE.md`
- **é–‹ç™¼æŒ‡å—**ï¼š`CLAUDE.md`
- **Bug å ±å‘Š**ï¼š`BUG_REPORT.md`
- **å®Œæ•´æ‰‹å†Š**ï¼šæœ¬æ–‡ä»¶

---

## ğŸ“ ç‰ˆæœ¬æ­·å²

### v2.0.0 (2025-11-29)

**æ–°åŠŸèƒ½**ï¼š
- âœ¨ æ¨¡çµ„åŒ–æ¶æ§‹é‡æ§‹
- âœ¨ å®Œæ•´é¡å‹æç¤º
- âœ¨ å–®å…ƒæ¸¬è©¦å¥—ä»¶
- âœ¨ å‘½ä»¤åˆ—ä»‹é¢æ”¹é€²

**Bug ä¿®å¾©**ï¼š
- âœ¨ æ–°å¢è¼¸å…¥è¼¸å‡ºæª”æ¡ˆç›¸åŒæª¢æŸ¥
- âœ¨ è‡ªå‹•å»ºç«‹æ—¥èªŒç›®éŒ„
- âœ¨ æ”¯æ´èˆŠç‰ˆ .xls æ ¼å¼

**æ–‡ä»¶**ï¼š
- âœ¨ æ–°å¢ CLAUDE.md
- âœ¨ æ–°å¢å®Œæ•´ä½¿ç”¨æ‰‹å†Š
- âœ¨ æ–°å¢æµç¨‹åœ–å’Œæ¶æ§‹åœ–

### v1.0.0

- åŸºæœ¬è³‡æ–™æ¸…æ´—åŠŸèƒ½
- å–®æª”ç¨‹å¼å¯¦ä½œ

---

## ğŸ“„ æˆæ¬Š

MIT License

---

## ğŸ‘¨â€ğŸ’» è²¢ç»

æ­¡è¿æäº¤ Pull Request æˆ–å»ºç«‹ Issueï¼

**è²¢ç»æµç¨‹**ï¼š
1. Fork å°ˆæ¡ˆ
2. å»ºç«‹åŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤è®Šæ›´ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. é–‹å•Ÿ Pull Request

---

**æ–‡ä»¶çµæŸ** - ç¥ä½¿ç”¨æ„‰å¿«ï¼ğŸ‰
